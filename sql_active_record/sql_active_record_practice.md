
# railsconsoleã§æ”¹è¡Œã—ãªãŒã‚‰å…¥åŠ›ã™ã‚‹æ–¹æ³•
è¨˜è¿°ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’beginã¨endã§å›²ã†ã€‚

# é€†å¼•ããƒã‚¿å¸³ã‚‰ã—ãã‚‚ã®
## å˜æ•°ãƒ†ãƒ¼ãƒ–ãƒ«
```rb
## ä¾‹ï¼šãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆç”Ÿå¾’ï¼‰ã‚’ã‚«ãƒ©ãƒ ï¼ˆå‡ºå¸­ç•ªå·ï¼‰ã®å€¤ï¼ˆ3ï¼‰ã§çµžã£ã¦å–å¾—
ãƒ†ãƒ¼ãƒ–ãƒ«.where(ã‚«ãƒ©ãƒ : çµžã‚ŠãŸã„å€¤)

## ä¾‹ï¼šãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆç”Ÿå¾’ï¼‰ã‚’ã‚«ãƒ©ãƒ ï¼ˆè‹—å­—ï¼‰ã®å€¤ï¼ˆç”°ä¸­ï¼‰ã§çµžã£ãŸã¨ãã«ä¸€ç•ªè‹¥ã„IDã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’å–å¾—
ãƒ†ãƒ¼ãƒ–ãƒ«.find_by(ã‚«ãƒ©ãƒ : çµžã‚ŠãŸã„å€¤)

## ä¾‹ï¼šãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆç”Ÿå¾’ï¼‰ã®æŒ‡å®šã—ãŸã‚«ãƒ©ãƒ ï¼ˆidã€ãƒ•ãƒ«ãƒãƒ¼ãƒ ï¼‰ã ã‘å–å¾—ã€€â€»whereãªã©ã§æŒ‡å®šã—ãªã„ã¨ãŸãã•ã‚“å‡ºã‚‹ã®ã§æ³¨æ„
ãƒ†ãƒ¼ãƒ–ãƒ«.select(:ã‚«ãƒ©ãƒ , :ã‚«ãƒ©ãƒ )

## ä¾‹ï¼šãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆç”Ÿå¾’ã®å¹´é½¢ï¼‰ã§ã€ã‚«ãƒ©ãƒ ï¼ˆç”Ÿå¹´æœˆæ—¥ï¼‰ãŒã€2005å¹´ä¸­ã€‘ã®è€…ã ã‘ã‚’å–å¾—
ãƒ†ãƒ¼ãƒ–ãƒ«.where(ã‚«ãƒ©ãƒ : Time.new(2005).beginning_of_year..Time.new(2005).end_of_year)

## ä¾‹ï¼šãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆç”Ÿå¾’ã®å¹´é½¢ï¼‰ã§ã€ã‚«ãƒ©ãƒ ï¼ˆå…¥å­¦å¹´æœˆæ—¥ï¼‰ãŒã€ç©ºæ¬„ã€‘ã®è€…ã ã‘ã‚’å–å¾—
ãƒ†ãƒ¼ãƒ–ãƒ«.where(ã‚«ãƒ©ãƒ : nil)

## ä¾‹ï¼šãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆå­¦è²»ï¼‰ã§ã€ã¾ã¨ã‚ãŸã„ã‚«ãƒ©ãƒ ï¼ˆæœˆï¼‰ã”ã¨ã«åˆè¨ˆã—ãŸã„ã‚«ãƒ©ãƒ ï¼ˆé ã‹ã‚Šé‡‘é¡ï¼‰ã®åˆè¨ˆã‚’å–å¾—
ãƒ†ãƒ¼ãƒ–ãƒ«.group(:ã¾ã¨ã‚ãŸã„ã‚«ãƒ©ãƒ ).sum("åˆè¨ˆã—ãŸã„ã‚«ãƒ©ãƒ ")

## ä¾‹ï¼šãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆå­¦è²»ï¼‰ã§ã€ã¾ã¨ã‚ãŸã„ã‚«ãƒ©ãƒ ï¼ˆæœˆã€å–å¾—ã—ãŸã„ã‚«ãƒ©ãƒ ã‚‚åŒã˜ï¼‰ã”ã¨ã« åˆè¨ˆã—ãŸã„ã‚«ãƒ©ãƒ ï¼ˆé ã‹ã‚Šé‡‘é¡ï¼‰ã®åˆè¨ˆã§ã€å¤šã„é †ã«5ä»¶ã€‘ã‚’å–å¾—
ãƒ†ãƒ¼ãƒ–ãƒ«.select("å–å¾—ã—ãŸã„ã‚«ãƒ©ãƒ ï¼ˆè¤‡æ•°å¯èƒ½ï¼‰, sum(åˆè¨ˆã—ãŸã„ã‚«ãƒ©ãƒ ) as åˆè¨ˆè¡Œã«ä»˜ã‘ã‚‹ã‚«ãƒ©ãƒ å")
.group(:ã¾ã¨ã‚ãŸã„ã‚«ãƒ©ãƒ ).limit(5).order(revenue: :desc)  

[ã€Railsã€‘ActiveRecordã§åˆè¨ˆ(sum)ã—ãŸåˆ—ã«åˆ—å(ASå¥)ã‚’ã¤ã‘ãŸã„ã€GROUP BYã€‘](https://qiita.com/Orangina1050/items/93dd407ac54f855d9d7d)
## ä¾‹ï¼šãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆå­¦è²»ï¼‰ã§ã€ã¾ã¨ã‚ãŸã„ã‚«ãƒ©ãƒ ï¼ˆæœˆã€å–å¾—ã—ãŸã„ã‚«ãƒ©ãƒ ã‚‚åŒã˜ï¼‰ã”ã¨ã« ã‚«ã‚¦ãƒ³ãƒˆè¡Œã‚«ãƒ©ãƒ ï¼ˆå¾´åŽæ¸ˆï¼‰ã®ã€ã‚«ã‚¦ãƒ³ãƒˆãŒ60ä»¥ä¸Šã®å¤šã„é †ã€‘ã‚’å–å¾—
ãƒ†ãƒ¼ãƒ–ãƒ«.select("å–å¾—ã—ãŸã„ã‚«ãƒ©ãƒ ï¼ˆè¤‡æ•°å¯èƒ½ï¼‰, count(*) as ã‚«ã‚¦ãƒ³ãƒˆè¡Œã«ä»˜ã‘ã‚‹ã‚«ãƒ©ãƒ å")  
.group(:ã¾ã¨ã‚ãŸã„ã‚«ãƒ©ãƒ ).having("ã‚«ã‚¦ãƒ³ãƒˆè¡Œã«ä»˜ã‘ã‚‹ã‚«ãƒ©ãƒ å >= 60").order("ã‚«ã‚¦ãƒ³ãƒˆè¡Œã«ä»˜ã‘ã‚‹ã‚«ãƒ©ãƒ å desc")

```
## è¤‡æ•°ãƒ†ãƒ¼ãƒ–ãƒ«
```rb
## ä¾‹ï¼šãƒ†ãƒ¼ãƒ–ãƒ«2ï¼ˆå‡ºå¸­è€…ï¼‰ã§ã€ãƒ†ãƒ¼ãƒ–ãƒ«1ï¼ˆç”Ÿå¾’ï¼‰ã§æŒ‡å®šã—ãŸæƒ…å ±ï¼ˆã‚«ãƒ©ãƒ ï¼ˆè‹—å­—ï¼‰ã®å€¤ï¼ç”°ä¸­ï¼‰ã¨ä¸€è‡´ã™ã‚‹ãƒ¬ã‚³ãƒ¼ãƒ‰ã®æ•°ã‚’å–å¾—
ãƒ†ãƒ¼ãƒ–ãƒ«1.find_by(ã‚«ãƒ©ãƒ å: çµžã‚ŠãŸã„å€¤).ãƒ†ãƒ¼ãƒ–ãƒ«2ï¼ˆè¤‡æ•°å½¢ï¼‰.size

## ä¾‹ï¼šãƒ†ãƒ¼ãƒ–ãƒ«2ï¼ˆå‡ºå¸­è€…ï¼‰ã«ãƒ†ãƒ¼ãƒ–ãƒ«1ï¼ˆç”Ÿå¾’ï¼‰ã®æƒ…å ±ã‚’çµåˆã—ã€ãƒ†ãƒ¼ãƒ–ãƒ«1ï¼ˆç”Ÿå¾’ï¼‰ã®ã‚«ãƒ©ãƒ ï¼ˆè‹—å­—ï¼‰ã®å€¤ãŒç”°ä¸­ã§ã‚ã‚‹ãƒ¬ã‚³ãƒ¼ãƒ‰ã®æ•°ã‚’å–å¾—
ãƒ†ãƒ¼ãƒ–ãƒ«2.joins(:ãƒ†ãƒ¼ãƒ–ãƒ«1).where(ãƒ†ãƒ¼ãƒ–ãƒ«1: { ã‚«ãƒ©ãƒ : çµžã‚ŠãŸã„å€¤ }).size

## ä¾‹ï¼šãƒ†ãƒ¼ãƒ–ãƒ«1 ï¼ˆç”Ÿå¾’ï¼‰ã®æƒ…å ±ã‚’å–å¾—ã€‚
## æ¡ä»¶ã¯ã€ãƒ†ãƒ¼ãƒ–ãƒ«3ï¼ˆç”Ÿå¾’ã®å¹´é½¢ï¼‰ã®ã‚«ãƒ©ãƒ ï¼ˆç”Ÿå¹´æœˆæ—¥ï¼‰ã§å€¤ï¼ˆ2005å¹´ä¸­ï¼‰ã¨ãªã£ã¦ã„ã‚‹ã“ã¨ã€‚
### å¯¾å¿œã™ã‚‹ã‚«ãƒ©ãƒ æœ‰ï¼šãƒ†ãƒ¼ãƒ–ãƒ«1â‡”ãƒ†ãƒ¼ãƒ–ãƒ«2ã€ãƒ†ãƒ¼ãƒ–ãƒ«2â‡”ãƒ†ãƒ¼ãƒ–ãƒ«3 ã€€
### â€»ãƒ†ãƒ¼ãƒ–ãƒ«2ã¯ä¸­é–“ãƒ†ãƒ¼ãƒ–ãƒ«ã§ã¯ãªã„
ãƒ†ãƒ¼ãƒ–ãƒ«1.joins(ãƒ†ãƒ¼ãƒ–ãƒ«2ï¼ˆè¤‡æ•°å½¢ï¼‰: :ãƒ†ãƒ¼ãƒ–ãƒ«3ï¼ˆè¤‡æ•°å½¢ï¼‰).where({ ãƒ†ãƒ¼ãƒ–ãƒ«3: ã‚«ãƒ©ãƒ : å€¤ })

## å±±ç”°ã•ã‚“ï¼ˆãƒ†ãƒ¼ãƒ–ãƒ«6ï¼‰ãŒè³¼å…¥ã—ãŸæœ¬ã®è‘—è€…æƒ…å ±ï¼ˆãƒ†ãƒ¼ãƒ–ãƒ«1ï¼‰ã‚’å–å¾—ã™ã‚‹ã€‚ãƒ†ãƒ¼ãƒ–ãƒ«ã¯ä»¥ä¸‹6ã¤ã€‚
### ãƒ†ãƒ¼ãƒ–ãƒ«1ã€€= è‘—è€…
### ãƒ†ãƒ¼ãƒ–ãƒ«2ã€€= æœ¬_è‘—è€…ï¼ˆä¸­é–“ãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰
### ãƒ†ãƒ¼ãƒ–ãƒ«3ã€€= æœ¬
### ãƒ†ãƒ¼ãƒ–ãƒ«4ã€€= åœ¨åº«
### ãƒ†ãƒ¼ãƒ–ãƒ«5ã€€= è²©å£²å±¥æ­´
### ãƒ†ãƒ¼ãƒ–ãƒ«6ã€€= è³¼å…¥è€…
## â–¼ã‚¢ã‚½ã‚·ã‚¨ãƒ¼ã‚·ãƒ§ãƒ³æŽ¥ç¶š
###  ãƒ†ãƒ¼ãƒ–ãƒ«6 â†’ ãƒ†ãƒ¼ãƒ–ãƒ«5 â†’ ãƒ†ãƒ¼ãƒ–ãƒ«4 â†’ ãƒ†ãƒ¼ãƒ–ãƒ«3 â†’ ãƒ†ãƒ¼ãƒ–ãƒ«1
ãƒ†ãƒ¼ãƒ–ãƒ«1.joins(ãƒ†ãƒ¼ãƒ–ãƒ«3ï¼ˆè¤‡æ•°å½¢ï¼‰: { ãƒ†ãƒ¼ãƒ–ãƒ«4ï¼ˆè¤‡æ•°å½¢ï¼‰: { ãƒ†ãƒ¼ãƒ–ãƒ«5sï¼ˆè¤‡æ•°å½¢ï¼‰: :ãƒ†ãƒ¼ãƒ–ãƒ«6ï¼ˆè¤‡æ•°å½¢ï¼‰}}).where(ãƒ†ãƒ¼ãƒ–ãƒ«6: {ã‚«ãƒ©ãƒ : çµžã‚ŠãŸã„å€¤ })
# ãƒ†ãƒ¼ãƒ–ãƒ«N,ã®NãŒå¤§ãã„æ–¹ãŒå¥¥ã«ãªã‚‹ã‚ˆã†ãªå…¥ã‚Œå­æ§‹é€ ã«ãªã£ã¦ã„ã‚‹ã€‚
# ãƒ†ãƒ¼ãƒ–ãƒ«2ãŒä¸­é–“ãƒ†ãƒ¼ãƒ–ãƒ«ã§ãªã„å ´åˆã¯ã€ãƒ†ãƒ¼ãƒ–ãƒ«2ã‚‚ã“ã®å…¥ã‚Œå­ã®ä»²é–“å…¥ã‚Šã€‚
```


## ãƒ†ãƒ¼ãƒ–ãƒ«æ•°ã«ã‚ˆã‚‹selectã€groupã®æ›¸ãæ–¹ã®é•ã„

| ã‚±ãƒ¼ã‚¹ | selectã®æ›¸ãæ–¹ | groupã®æ›¸ãæ–¹ | å‚™è€ƒ |
| --- | --- | --- | --- |
| å˜ä¸€ãƒ†ãƒ¼ãƒ–ãƒ« | `Model.select(:column1, :column2)` | `Model.group(:column)` | ãƒ†ãƒ¼ãƒ–ãƒ«åã®æŒ‡å®šä¸è¦ |
| è¤‡æ•°ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆjoinsä½¿ç”¨ï¼‰ | `Model.joins(...).select("table1.column, table2.column")` | `Model.joins(...).group("table.column")` | æ˜Žç¤ºçš„ã« `table.column` æŒ‡å®šãŒå¿…è¦ |
| è¤‡æ•°ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆincludesä½¿ç”¨ + SQLæ›¸ãå ´åˆï¼‰ | åŒä¸Šï¼ˆincludesã§ã‚‚SQLã‚’æ›¸ããªã‚‰æ˜Žç¤ºï¼‰ | åŒä¸Š | `includes`ã¯é€šå¸¸Eager Loadingãªã®ã§SQLã§æŒ‡å®šã—ãªã„ã“ã¨ã‚‚ã‚ã‚‹ |

# æ™‚é–“é–¢é€£ã®æ›¸ãæ–¹
### Time.new
ðŸ”–[Ruby3.4ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ãƒžãƒ‹ãƒ¥ã‚¢ãƒ«](https://docs.ruby-lang.org/ja/latest/method/Time/s/new.html)  
Time.new(year, mon = nil, day = nil, hour = nil, min = nil, sec = nil, in: nil)  
 â†’ å¼•æ•°ã§æŒ‡å®šã—ãŸåœ°æ–¹æ™‚ã® Time ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¿”ã—ã¾ã™ã€‚

mon day hour min sec ã« nil ã‚’æŒ‡å®šã—ãŸå ´åˆã®å€¤ã¯ã€ãã®å¼•æ•°ãŒã¨ã‚Šå¾—ã‚‹æœ€å°ã®å€¤ã§ã™ã€‚  
zone ã¨ in ã« nil ã‚’æŒ‡å®šã—ãŸå ´åˆã®å€¤ã¯ã€ç¾åœ¨ã®ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ã«å¾“ã„ã¾ã™ã€‚  

```rb
Time.new(2005).beginning_of_year..Time.new(2005).end_of_year
# => 2005-01-01 00:00:00 +0900..2005-12-31 23:59:59.999999999 +0900

p Time.new(2008, 6, 21, 13, 30, 0, "+09:00") 
# => 2008-06-21 13:30:00 +0900
```

### beginning_of_yearã€end_of_year 
ðŸ”–[Railsã‚¬ã‚¤ãƒ‰](https://railsguides.jp/active_support_core_extensions.html#beginning-of-year%E3%80%81end-of-year)  
beginning_of_yearãƒ¡ã‚½ãƒƒãƒ‰ã¨end_of_yearãƒ¡ã‚½ãƒƒãƒ‰ã¯ã€ãã®å¹´ã®ã€Œæœ€åˆã®æ—¥ã€ã¨ã€Œæœ€å¾Œã®æ—¥ã€ã‚’ãã‚Œãžã‚Œè¿”ã—ã¾ã™ã€‚  
  
```rb
d = Date.new(2010, 5, 9) # => Sun, 09 May 2010
d.beginning_of_year      # => Fri, 01 Jan 2010
d.end_of_year            # => Fri, 31 Dec 2010
```